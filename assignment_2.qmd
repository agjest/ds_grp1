---
title: "assignment_2"
format: html
editor: visual
bibliography: [ds_grp1.bib]
Author: Espen Knutsen, Marius Martinussen og René Rødde Bracci
---

```{r}
#| label: setup
#| echo: false
#| output: false
library(tidyverse)
library(vtable)

```

# Innledning

I denne oppgaven har vi sett på sammenhengen mellom utdanning og inntekt, høyde og inntekt, utdanning og høyde, fordeling mellom menn og kvinner i ulike inntektsgrupper i forhold til høyde, men også fordelingen mellom menn og kvinner.
De ulike inntektsgruppene er nullinntekt (hoydeZeroInc), normalinntekt (hoydeNormInc), høyinntekt (hoydeHighInc).Videre ser vi på hvordan observasjoner i hoydeZeroInc og hoydeHighInc skiller seg ut i forhold til hoydeNormInc når det kommer til høyde og utdanning.

## Litteraturgjennomgang

### Utdanning og inntekt

Når det kommer til sammenheng mellom utdanning og inntekt, viser det seg at menn som ikke ble uteksaminert fra videregående en halv tomme (1,27 cm) kortere enn gjennomsnittet, og er mer enn en tomme (2,54 cm) kortere enn en gjennomsnittlig høyskoleutdannet mann [@Deaton&Arora2009].
Når det kommer til kvinner, er forskjellen litt mindre [@Deaton&Arora2009].

Så hvorfor har høyere mennesker bedre utdanning og høyere inntekt?

Ifølge @Case&Paxson2008 så har høyere mennesker større mulighet for å ha nådd sitt fulle kognitive potensiale enn lavere personer.
Alt henger sammen med barndommen og hvor godt ernært et barn er gjennom hele barndommen.
I tillegg henger det sammen med om barnet har vært skånet for barnesykdommer som har hatt potensialet til å bremse utviklingen i forhold til høyde.
Har ikke barnet vært sykt, så vil de nå voksenhøyden som ligger i genet deres [@Case&Paxson2008].
I tillegg nevner @Case&Paxson2008 at det er en sammenheng mellom utvikling kognitivt og fysisk.
 Det vil si at et barn som ikke har nådd sin fulle mulige høyde, har heller ikke utviklet sitt fulle kognitive potensiale.
Det er nemlig barn som mangler full kognitiv utvikling som står for lavere utdanningsnivå og lavere inntekt i voksen alder [@Case&Paxson2008].

### Høyde og inntekt

Når det kommer til forholdet mellom høyde og inntekt, har @Deaton&Arora2009 hentet data fra Gallup-Healthways Well-Being Index for å se på forholdet mellom høyde og inntekt.
Ifølge @Deaton&Arora2009, var menn som var over gjennomsnittlig høyde (177,8 cm) et trinn på stigen over menn som er under gjennomsnittlig høyde.
For kvinner er forskjellen mindre.
Kvinner under gjennomsnittlig høyde (162,6 cm) ligger litt mindre enn en tidel av et trinn under kvinner med over gjennomsnittlig høyde.
Forskjellene kan virke små, men sammenlignet med faktorer som påvirker stigen, er inntekt en utgjørende faktor [@Deaton&Arora2009].
Øker vi høyden med en ekstra tomme på den såkalt stigen med effekten av en endring i inntekt, så vil hver ekstra tomme høyde ha samme effekt som en økning på 3,8% i familie inntekt for kvinner og 4,4% økning for menn.

### Utdanning og høyde

Ifølge @Case&Paxson2008, er det sammenheng mellom utdanning og høyde som fører til økt inntekt.
Dette skyldes at høyere mennesker har større sannsynlighet for å ha nådd sitt fulle kognitive potensial enn lavere personer [@Case&Paxson2008].

The `echo: false` option disables the printing of code (only output is displayed).

```{r}
#| echo: false
hoyde <- modelr::heights
hoyde <- hoyde %>%
mutate(
bmi = weight * 0.4536/(height * 2.54/100)^2,
married = fct_collapse(
.f = marital,
married = "married",
other_level = "not married"
),
edu_fac = cut(
x = education,
breaks = c(0, 12, 14, 16, 21),
labels = c("not_hs", "not_cc", "not_col", "col_plus"),
right = FALSE
)
)
```

```{r}
#| echo: false
# Inntekt lik 0
hoydeZeroInc <- hoyde |>
filter(income == 0)
# «Normal» inntekt
hoydeNormInc <- hoyde |>
filter(income > 0 & income < 343830)
hoydeHighInc <- hoyde |>
filter(income == 343830)
```

```{r}
#| echo: false
hoyde |>
ggplot(
mapping = aes(
x = height,
y = income
)
) +
geom_jitter(
size = 1,
alpha = 0.40
) +
geom_smooth(
formula = y ~ x,
method = "lm",
colour = "black",
lwd = 0.75,
se = FALSE
)
```

```{r}
#| echo: false
hoydeNormInc |>
ggplot(
mapping = aes(
x = height,
y = income
)
) +
geom_jitter(
size = 1,
alpha = 0.40
) +
geom_smooth(
formula = y ~ x,
method = "lm",
colour = "black",
lwd = 0.75,
se = FALSE
)
```

```{r}
#| echo: false
meanHeightMale <- hoyde |>
filter(sex == 'male') %>%
select(height) |>
# konverterer en tibble med 3402 rekker og 1 kolonne
# til en vektor med 3402 elementer siden mean() forlanger en
# vektor som input
pull() |>
# finner gjennomsnittet av verdiene i vektoren
mean()
meanHeightFemale <- hoyde |>
filter(sex == 'female') %>%
select(height) |>
pull() |>
mean()
# standard deviation
sdHeightMale <- hoyde |>
filter(sex == 'male') |>
select(height) |>
pull() |>
sd()
sdHeightFemale <- hoyde |>
filter(sex == 'female') |>
select(height) |>
pull() |>
sd()
```

```{r}
#| echo: false
ggplot(hoydeNormInc, aes(
  x = edu_fac,
  y = income
)) +
  geom_jitter(alpha = 0.5) +
  geom_smooth(method = "lm")
```

```{r}
#| echo: false
ggplot(hoydeNormInc, aes(
  x = height,
  y = income
)
) +
geom_point() +
  facet_wrap(~edu_fac)

```

```{r}
na <- is.na(hoyde)
```

```{r}
#| echo: false
hoydeNormInc |>
  filter(!is.na(edu_fac)) |> 
ggplot(
mapping = aes(
x = edu_fac,
y = income,
colour = edu_fac
)
) +
geom_jitter(
size = 1,
alpha = 0.40
) +
geom_smooth(
method = "lm"
)
```

```{r}
#| echo: false
hoydeNormInc |>
  filter(!is.na(edu_fac)) |> 
ggplot(
mapping = aes(
x = edu_fac,
y = height,
colour = edu_fac
)
) +
geom_jitter(
size = 1,
alpha = 0.40
)
```

```{r}
#| echo: false
hoydeNormInc |>
  filter(!is.na(edu_fac)) |> 
ggplot(
mapping = aes(
x = height,
y = income,
colour = edu_fac
)
) +
geom_jitter(
size = 1,
alpha = 0.40
) +
  facet_wrap(~edu_fac)
```

```{r}
#| echo: false
hoydeZeroInc |>
st("sex")
```

```{r}
#| echo: false
hoydeHighInc |>
st("sex")
```

```{r}
#| echo: false
hoyde |> 
  st()
```

VIDERE

```{r}
#| echo: false
hoydeZeroInc |> 
  st(c("height", "edu_fac"))
```

```{r}
#| echo: false
hoydeNormInc |> 
  st(c("height", "edu_fac"))
```

```{r}
#| echo: false
hoydeHighInc |> 
  st(c("height", "edu_fac"))
```

```{r}
hoyde <- hoyde |> 
  mutate(
    income_class = case_when(
    income == 0 ~ "zeroinc",
    income > 0 & income < 343830 ~ "norminc",
    income >= 343830 ~ "highinc"
    ))
```

```{r}
hoyde |> 
  ggplot(mapping = aes(
    x = edu_fac,
    y = income,
    colour = income_class
  )) +
  geom_jitter(alpha = 0.2)
```

```{r}
hoyde |> ggplot() +
  geom_point(data = hoyde, mapping = aes(x = education, y = height, colour = factor(income_class), shape = sex))
```

```{r}
hoydeNormInc |> 
  st(c("height", "education", "sex"))
```

```{r}
hoydeHighInc |> 
  st(c("height", "education", "sex"))
```

```{r}
hoydeZeroInc |> 
  st(c("height", "education", "sex"))
```
